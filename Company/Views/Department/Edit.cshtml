@model Company.Models.Department

<div id="departmentapp1" class="container mt-4">
    <div class="card shadow-lg p-4">
        <h3 class="text-center mb-4 text-primary">Edit Department</h3>

        <div class="mb-3">
            <label class="form-label fw-bold">Name of Department:</label>
            <input v-model="department.name" class="form-control form-control-lg" />
        </div>

        <div class="mb-3">
            <label class="form-label fw-bold">Description of Department:</label>
            <textarea v-model="department.description" class="form-control form-control-lg"></textarea>
        </div>

        <fieldset class="border p-3 mb-4">
            <legend class="w-auto text-success fw-bold">Employees</legend>
            <div v-for="(itemEmloyee, index) in department.employees" :key="index" class="mb-3 p-3 border rounded bg-light">
                <input type="hidden" v-model="itemEmloyee.id" />

                <div class="mb-2">
                    <label class="form-label fw-bold">Employee Name:</label>
                    <input v-model="itemEmloyee.name" class="form-control" placeholder="Employee Name" />
                </div>

                <div class="form-group">
                    <label class="fw-bold">Role</label><br />
                    <div class="form-check form-check-inline">
                        <input type="radio" :name="'role'+index" v-model="itemEmloyee.isManger" value="true" class="form-check-input" />
                        <label class="form-check-label">Manager</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input type="radio" :name="'role'+index" v-model="itemEmloyee.isManger" value="false" class="form-check-input" />
                        <label class="form-check-label">Member</label>
                    </div>
                </div>
            </div>
        </fieldset>

        <button type="button" v-on:click="save()" class="btn btn-success w-100 fw-bold">
            <i class="fas fa-save"></i> Save
        </button>
    </div>
</div>

<script type="text/javascript">
    var department_App = new Vue({
        el: "#departmentapp1",
        data: {
            department: {
                id: @Model.Id,
                name: null,
                description: null,
                employees: [],
            },
        },
        methods: {
            async load() {
                await axios.get(`/Department/GetById/${@Model.Id}`)
                    .then(response => {
                        this.department = response.data;
                    })
                    .catch((error) => {
                        console.log(error);
                    });
            },
            save() {
                var formdata = convertObjectToFormData(this.department);
                axios.post('/Department/Edit', formdata)
                    .then(function (response) {
                        console.log(response);
                        window.location.href = "/Department/Index";
                    })
                    .catch(function (error) {
                        console.log("Error", error);
                    });
            },
        },
        beforeMount() {
            this.load();
        },
    });
</script>

<!-- Add Bootstrap & Font Awesome -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
<script src="https://kit.fontawesome.com/a076d05399.js"></script>
